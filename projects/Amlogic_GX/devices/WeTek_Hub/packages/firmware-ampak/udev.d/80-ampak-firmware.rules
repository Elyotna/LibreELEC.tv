################################################################################
# udev rules file for loading ampak bluetooth firmware
################################################################################

ACTION!="add", GOTO="end"
SUBSYSTEMS=="sdio", ATTRS{vendor}=="0x02d0", ATTRS{device}=="0x4330", GOTO="begin"
SUBSYSTEMS=="sdio", ATTRS{vendor}=="0x02d0", ATTRS{device}=="0x4335", GOTO="begin"
GOTO="end"
LABEL="begin"

# AP6330 / bcm4330 and bcm40183b2
ATTRS{vendor}=="0x02d0", ATTRS{device}=="0x4330", ENV{brcm_device}="bcm40183b2"

# AP6335 / bcm4335 and bcm4335c0
ATTRS{vendor}=="0x02d0", ATTRS{device}=="0x4335", ENV{brcm_device}="bcm4335c0"

ENV{brcm_device}=="bcm*", ACTION=="add", TAG+="systemd", ENV{SYSTEMD_WANTS}+="ampak-firmware@$env{brcm_device}.service"
LABEL="end"
